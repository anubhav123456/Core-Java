
---

# ğŸ“Œ Notes on `ReentrantLock.isLocked()`

## ğŸ”¹ What is `isLocked()`?

```java
public boolean isLocked()
```

### âœ… Behavior

* **Returns `true`** â†’ if the lock is currently held by **any thread**
* **Returns `false`** â†’ if the lock is **free**

ğŸ“Œ Important:

* It **does NOT tell which thread** holds the lock
* It **does NOT block**
* Mainly used for **monitoring / logging**, **not synchronization**

---

## ğŸ”¹ Your Code Overview

### Classes Used

* `ReentrantLock` â†’ Explicit lock from `java.util.concurrent.locks`
* `Thread` â†’ Multiple threads competing for same lock

---

## ğŸ”¹ Code Explanation (Step-by-Step)

### 1ï¸âƒ£ Shared Lock

```java
ReentrantLock lock = new ReentrantLock();
```

* A **single lock** shared by all threads

---

### 2ï¸âƒ£ Thread Class

```java
class MyThread extends Thread {
    ReentrantLock lock;
}
```

Each thread:

* Receives the **same lock**
* Tries to acquire it

---

### 3ï¸âƒ£ `isLocked()` Usage

```java
while (lock.isLocked()) {
    System.out.println("Lock is not available for : " + getName());
}
```

ğŸ“Œ Meaning:

* If **any thread already holds the lock**
* Other threads **keep printing this message**

âš ï¸ **Problem**:

* This is **busy waiting**
* Consumes CPU unnecessarily

---

### 4ï¸âƒ£ Lock Acquisition

```java
lock.lock();
System.out.println(getName() + " has acquired the lock");
```

* Thread **blocks here** until lock becomes free

---

### 5ï¸âƒ£ Critical Section

```java
for(int i = 0; i < 5; i++) {
    Thread.sleep(500);
    System.out.println(getName() + " : " + i);
}
```

* Only **one thread at a time** executes this loop

---

### 6ï¸âƒ£ Lock Release

```java
lock.unlock();
System.out.println(getName() + " has released the lock");
```

ğŸ“Œ **Must be called**, otherwise deadlock may occur

---

## ğŸ”¹ Full Code Snippet (As Given)

```java
import java.util.concurrent.locks.ReentrantLock;

class MyThread extends Thread {
    ReentrantLock lock;

    public MyThread(String name, ReentrantLock lock) {
        super(name);
        this.lock = lock;
    }

    @Override
    public void run() {
        while (lock.isLocked()) {
            System.out.println("Lock is not available for : " + getName());
        }

        System.out.println(getName() + " is trying to acquire the lock");
        lock.lock();

        System.out.println(getName() + " has acquired the lock");

        for (int i = 0; i < 5; i++) {
            try {
                Thread.sleep(500);
            } catch (InterruptedException e) {
                throw new RuntimeException(e);
            }
            System.out.println(getName() + " : " + i);
        }

        lock.unlock();
        System.out.println(getName() + " has released the lock");
    }
}

public class Main {
    public static void main(String[] args) {
        ReentrantLock lock = new ReentrantLock();

        MyThread[] threads = new MyThread[5];

        for (int i = 0; i < 5; i++) {
            threads[i] = new MyThread("Thread " + (i + 1), lock);
        }

        for (int i = 0; i < 5; i++) {
            threads[i].start();
        }
    }
}
```

---

## ğŸ”¹ Sample Output (One Possible Run)

```
Thread 1 is trying to acquire the lock
Thread 1 has acquired the lock
Lock is not available for : Thread 2
Lock is not available for : Thread 3
Lock is not available for : Thread 4
Lock is not available for : Thread 5
Thread 1 : 0
Thread 1 : 1
Thread 1 : 2
Thread 1 : 3
Thread 1 : 4
Thread 1 has released the lock
Thread 2 is trying to acquire the lock
Thread 2 has acquired the lock
Thread 2 : 0
Thread 2 : 1
...
```

ğŸ“Œ Order may vary due to **thread scheduling**

---

## ğŸ”¹ âš ï¸ Important Issues in Current Code

### âŒ Busy Waiting (Bad Practice)

```java
while (lock.isLocked()) { ... }
```

Problems:

* High CPU usage
* Infinite loop risk
* Not thread-safe logic

---

## ğŸ”¹ âœ… Better Approach (Recommended)

### Use `tryLock()` instead

```java
if (lock.tryLock()) {
    try {
        // critical section
    } finally {
        lock.unlock();
    }
} else {
    System.out.println("Lock not available for " + getName());
}
```

âœ” No CPU wastage
âœ” Cleaner
âœ” Interview-friendly

---

## ğŸ”¹ Interview Key Takeaways â­

* `isLocked()`
  â†’ **Only checks state**, does not block
* `lock()`
  â†’ **Blocks until available**
* `tryLock()`
  â†’ **Non-blocking alternative**
* Never use `isLocked()` for synchronization logic

---
